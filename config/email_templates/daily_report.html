<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }
        .container { max-width: 800px; margin: 0 auto; padding: 20px; }
        .header { background: #f8f9fa; padding: 20px; border-radius: 5px; margin-bottom: 20px; }
        .section { margin-bottom: 30px; border: 1px solid #dee2e6; border-radius: 5px; padding: 15px; }
        .section-title { color: #007bff; border-bottom: 2px solid #007bff; padding-bottom: 5px; margin-top: 0; }
        table { width: 100%; border-collapse: collapse; margin: 10px 0; }
        th, td { padding: 10px; text-align: left; border: 1px solid #dee2e6; }
        th { background-color: #f8f9fa; font-weight: bold; }
        .stat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        .stat-card { background: #f8f9fa; padding: 15px; border-radius: 5px; text-align: center; }
        .stat-value { font-size: 24px; font-weight: bold; color: #007bff; }
        .stat-label { font-size: 12px; color: #6c757d; text-transform: uppercase; }
        .highlight { background-color: #fff3cd; padding: 10px; border-radius: 5px; }
        .footer { margin-top: 30px; padding-top: 20px; border-top: 1px solid #dee2e6; color: #6c757d; font-size: 12px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ç½‘ç»œæµé‡ç›‘æ§æŠ¥å‘Š - {{date}}</h1>
            <p>æŠ¥å‘Šç”Ÿæˆæ—¶é—´: {{generated_time}}</p>
        </div>

        <div class="section">
            <h2 class="section-title">ğŸ“Š æ¦‚è§ˆç»Ÿè®¡</h2>
            <div class="stat-grid">
                <div class="stat-card">
                    <div class="stat-value">{{total_records}}</div>
                    <div class="stat-label">æ€»ç›‘æ§è®°å½•æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">{{total_upload_mb}} MB</div>
                    <div class="stat-label">æ€»ä¸Šä¼ æµé‡</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">{{total_download_mb}} MB</div>
                    <div class="stat-label">æ€»ä¸‹è½½æµé‡</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">{{unique_processes}}</div>
                    <div class="stat-label">å”¯ä¸€è¿›ç¨‹æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">{{unique_remotes}}</div>
                    <div class="stat-label">å”¯ä¸€è¿œç¨‹åœ°å€</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">{{duration_hours}} h</div>
                    <div class="stat-label">ç›‘æ§æ—¶é•¿</div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2 class="section-title">ğŸ† æµé‡æ’è¡Œæ¦œ</h2>
            
            <h3>ğŸ“ˆ è¿›ç¨‹æµé‡æ’è¡Œ (å‰10)</h3>
            <table>
                <thead>
                    <tr>
                        <th>æ’å</th>
                        <th>è¿›ç¨‹åç§°</th>
                        <th>ä¸Šä¼  (MB)</th>
                        <th>ä¸‹è½½ (MB)</th>
                        <th>æ€»æµé‡ (MB)</th>
                        <th>è¿æ¥æ•°</th>
                    </tr>
                </thead>
                <tbody>
                    {% for process in top_processes %}
                    <tr>
                        <td>{{loop.index}}</td>
                        <td>{{process.process_name}}</td>
                        <td>{{process.upload_mb|round(2)}}</td>
                        <td>{{process.download_mb|round(2)}}</td>
                        <td>{{process.total_mb|round(2)}}</td>
                        <td>{{process.connections}}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            <h3>ğŸŒ è¿œç¨‹åœ°å€æ’è¡Œ (å‰10)</h3>
            <table>
                <thead>
                    <tr>
                        <th>æ’å</th>
                        <th>è¿œç¨‹åœ°å€</th>
                        <th>ä¸Šä¼  (MB)</th>
                        <th>ä¸‹è½½ (MB)</th>
                        <th>è®¿é—®æ¬¡æ•°</th>
                        <th>ä¸»è¦åè®®</th>
                    </tr>
                </thead>
                <tbody>
                    {% for remote in top_remotes %}
                    <tr>
                        <td>{{loop.index}}</td>
                        <td>{{remote.remote_address|truncate(30)}}</td>
                        <td>{{remote.upload_mb|round(2)}}</td>
                        <td>{{remote.download_mb|round(2)}}</td>
                        <td>{{remote.access_count}}</td>
                        <td>{{remote.common_protocol}}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="section">
            <h2 class="section-title">ğŸ•’ æ—¶é—´åˆ†å¸ƒ</h2>
            <h3>å°æ—¶æµé‡åˆ†å¸ƒ</h3>
            <table>
                <thead>
                    <tr>
                        <th>æ—¶é—´æ®µ</th>
                        <th>ä¸Šä¼ æµé‡ (MB)</th>
                        <th>ä¸‹è½½æµé‡ (MB)</th>
                        <th>è¿æ¥æ•°</th>
                        <th>å¹³å‡é€Ÿç‡ (KB/s)</th>
                    </tr>
                </thead>
                <tbody>
                    {% for hour in hourly_distribution %}
                    <tr>
                        <td>{{hour.hour}}:00 - {{hour.hour}}:59</td>
                        <td>{{hour.upload_mb|round(2)}}</td>
                        <td>{{hour.download_mb|round(2)}}</td>
                        <td>{{hour.connections}}</td>
                        <td>{{hour.avg_rate|round(2)}}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        {% if alerts %}
        <div class="section">
            <h2 class="section-title">âš ï¸ å¼‚å¸¸æ£€æµ‹</h2>
            <div class="highlight">
                {% for alert in alerts %}
                <p><strong>{{alert.type}}:</strong> {{alert.message}}</p>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <div class="section">
            <h2 class="section-title">ğŸ“ é™„ä»¶ä¿¡æ¯</h2>
            <ul>
                <li><strong>è¯¦ç»†æŠ¥å‘Š:</strong> report_{{date_str}}.json - åŒ…å«æ‰€æœ‰åŸå§‹è®°å½•æ•°æ®</li>
                <li><strong>æ±‡æ€»æŠ¥å‘Š:</strong> summary_{{date_str}}.json - åŒ…å«å„ç±»æ±‡æ€»ç»Ÿè®¡</li>
                <li><strong>ç»Ÿè®¡æŠ¥å‘Š:</strong> stats_{{date_str}}.json - åŒ…å«è¯¦ç»†ç»Ÿè®¡æŒ‡æ ‡</li>
                <li><strong>CSVæ ¼å¼:</strong> report_{{date_str}}.csv - ç”¨äºExcelåˆ†æ</li>
            </ul>
            <p><em>æ³¨æ„ï¼šé™„ä»¶å¯èƒ½è¢«å‹ç¼©ä¸ºZIPæ–‡ä»¶å‘é€</em></p>
        </div>

        <div class="footer">
            <p>è¿™æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„æŠ¥å‘Šï¼Œè¯·å‹¿ç›´æ¥å›å¤æ­¤é‚®ä»¶ã€‚</p>
            <p>å¦‚éœ€å¸®åŠ©æˆ–æœ‰é—®é¢˜ï¼Œè¯·è”ç³»ç³»ç»Ÿç®¡ç†å‘˜ã€‚</p>
            <p>Â© 2025 ç½‘ç»œç›‘æ§ç³»ç»Ÿ | ç‰ˆæœ¬: 1.0.0</p>
        </div>
    </div>
</body>
</html>
